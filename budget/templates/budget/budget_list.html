{% extends 'budget/base.html' %}
{% load budget_extras %}

{% block title %}{{ title }} - Budget Tracker{% endblock %}

{% block content %}
<div class="d-flex" style="gap: 1.5rem; align-items: flex-start;">
    <!-- Categories Sidebar -->
    <div class="card custom-card categories-sidebar" style="width: 250px; max-height: 600px; overflow-y: auto;">
        <div class="card-header d-flex justify-content-between align-items-center custom-card-header-border custom-card-header-purple">
            <h5 class="card-title custom-text-blk mb-0">Categories</h5>
            <a href="{% url 'budget:category-create' %}" class="btn btn-primary btn-sm custom-btn-purple p-1 px-2" title="Add Category" style="font-size: 1rem; line-height: 1;">
                <span style="font-weight: bold; font-size: 1.2em;">&#43;</span>
            </a>
        </div>
        <div class="card-body" style="padding: 1rem;">
            <ul class="list-group">
                {% for category in categories %}
                    <li class="list-group-item">{{ category.name }}</li>
                {% empty %}
                    <li class="list-group-item text-muted">No categories found.</li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <!-- Budgets List -->
    <div class="flex-grow-1">
        <div class="card custom-card">
            <div class="card-header d-flex justify-content-between align-items-center custom-card-header-border custom-card-header-purple">
                <h5 class="card-title custom-text-blk mb-0">{{ title }}</h5>
                <a href="{% url create_url %}" class="btn btn-primary btn-sm custom-btn-purple">+ Add New</a>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table custom-no-bg">
                        <thead>
                            <tr class="custom-text-align-center">
                                {% for header in headers %}
                                    <th class="custom-col-name-purple">{{ header }}</th>
                                {% endfor %}
                                <th class="custom-col-name-purple">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for budget in object_list %}
                                <tr class="custom-text-align-center">
                                    <td class="custom-text-blk">{{ budget.category.name }}</td>
                                    <td class="custom-text-blk">{{ budget.amount|peso_format }}</td>
                                    <td class="custom-text-blk">{{ budget.month|date:"F Y" }}</td>
                                    <td>
                                        <div class="btn-group">
                                            <a href="{% url update_url budget.id %}" class="btn btn-sm btn-outline-primary custom-edit-btn">Edit</a>
                                            <a href="{% url delete_url budget.id %}" class="btn btn-sm btn-outline-danger custom-delete-btn">Delete</a>
                                        </div>
                                    </td>
                                </tr>
                            {% empty %}
                                <tr>
                                    <td colspan="{{ headers|length|add:1 }}" class="text-center">No budgets found.</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}